import{a as Y}from"./chunk-DC233EST.js";import{c as F,d as j}from"./chunk-K6BAALZU.js";import{a as U}from"./chunk-PNRCHS3F.js";import{b as L,c as P,d as G,e as I,f as O,g as W,i as B,j as q,k as z,m as R,n as H}from"./chunk-GT7YRUEU.js";import{Ca as N,Lb as A,Ra as p,Sa as g,Wa as w,X as m,Xa as e,Y as s,Ya as t,Z as C,Za as v,_ as x,bb as M,cb as S,db as f,ea as b,eb as V,ib as o,jb as T,kb as D,lb as k,mb as _,nb as h,ob as E,sa as d,wa as y}from"./chunk-5P4XIA3I.js";function K(a,r){if(a&1&&(e(0,"div",26),o(1),t()),a&2){let n=f();d(),D(" ",n.getTypeDescription(n.formData.type)," ")}}function Q(a,r){a&1&&(e(0,"div",43)(1,"p",44),o(2," \u26A0\uFE0F Attention: Cette demande d\xE9passe votre solde disponible (18 jours) "),t()())}function X(a,r){if(a&1&&(e(0,"div",38)(1,"div",9),C(),e(2,"svg",39),v(3,"path",40),t(),x(),e(4,"div")(5,"p",41),o(6),t(),e(7,"p",42),o(8),t()()()(),p(9,Q,3,0,"div",43)),a&2){let n=f();d(6),D(" Dur\xE9e: ",n.dureeCalculee()," jour(s) ouvrables "),d(2),k(" Du ",n.formatDate(n.formData.dateDebut)," au ",n.formatDate(n.formData.dateFin)," "),d(),g(n.dureeCalculee()>18?9:-1)}}function Z(a,r){if(a&1){let n=M();e(0,"div",52)(1,"span",53),o(2),t(),e(3,"button",54),S("click",function(){m(n);let u=f(2);return s(u.retirerFichier())}),C(),e(4,"svg",55),v(5,"path",56),t()()()}if(a&2){let n,i=f(2);d(2),T((n=i.fichierSelectionne())==null?null:n.name)}}function $(a,r){if(a&1){let n=M();e(0,"div")(1,"label",19),o(2," Certificat m\xE9dical * "),t(),e(3,"div",45),C(),e(4,"svg",46),v(5,"path",47),t(),x(),e(6,"div",48)(7,"label",49)(8,"span",50),o(9," Choisir le certificat "),t(),e(10,"input",51),S("change",function(u){m(n);let c=f();return s(c.onFileSelect(u))}),t()(),e(11,"p",32),o(12," PDF ou image jusqu'\xE0 5MB "),t()()(),p(13,Z,6,1,"div",52),t()}if(a&2){let n=f();d(13),g(n.fichierSelectionne()?13:-1)}}function ee(a,r){if(a&1&&(e(0,"span",60),o(1),t()),a&2){let n=f(2);d(),D("(Insuffisant - minimum ",n.getPreavisMinimum()," jours)")}}function te(a,r){if(a&1&&(e(0,"div",34)(1,"p",57),C(),e(2,"svg",58),v(3,"path",59),t(),o(4),p(5,ee,2,1,"span",60),t()()),a&2){let n=f();d(4),D(" Pr\xE9avis: ",n.calculerPreavis()," jours "),d(),g(n.calculerPreavis()<n.getPreavisMinimum()?5:-1)}}function ie(a,r){a&1&&(C(),e(0,"svg",61),v(1,"circle",62)(2,"path",63),t(),o(3," Envoi en cours... "))}function ne(a,r){a&1&&o(0," Soumettre la demande ")}var J=class a{constructor(r,n,i){this.congeService=r;this.authService=n;this.router=i}formData={type:"",dateDebut:"",dateFin:"",motif:"",remplacant:"",contactUrgence:""};fichierSelectionne=b(null);enCoursEnvoi=b(!1);dureeCalculee=b(0);dateMinimum(){let r=new Date;return r.setDate(r.getDate()+2),r.toISOString().split("T")[0]}calculerDuree(){if(this.formData.dateDebut&&this.formData.dateFin){let r=this.congeService.calculerJoursOuvrables(this.formData.dateDebut,this.formData.dateFin);this.dureeCalculee.set(r)}else this.dureeCalculee.set(0)}calculerPreavis(){if(this.formData.dateDebut){let r=new Date,i=new Date(this.formData.dateDebut).getTime()-r.getTime();return Math.ceil(i/(1e3*60*60*24))}return 0}getPreavisMinimum(){switch(this.formData.type){case"CONGE_PAYE":return 15;case"CONGE_SANS_SOLDE":return 30;default:return 2}}peutSoumettre(){return!(!this.formData.type||!this.formData.dateDebut||!this.formData.dateFin||!this.formData.motif||this.calculerPreavis()<this.getPreavisMinimum()&&this.formData.type!=="CONGE_MALADIE"||this.formData.type==="CONGE_MALADIE"&&!this.fichierSelectionne())}onFileSelect(r){let n=r.target.files[0];n&&this.fichierSelectionne.set(n)}retirerFichier(){this.fichierSelectionne.set(null)}getTypeDescription(r){switch(r){case"CONGE_PAYE":return"Cong\xE9 pay\xE9 annuel. N\xE9cessite un pr\xE9avis de 15 jours minimum.";case"CONGE_MALADIE":return"Cong\xE9 pour raison m\xE9dicale. Certificat m\xE9dical obligatoire.";case"CONGE_MATERNITE":return"Cong\xE9 maternit\xE9/paternit\xE9. Documents justificatifs requis.";case"CONGE_SANS_SOLDE":return"Cong\xE9 non r\xE9mun\xE9r\xE9. N\xE9cessite un pr\xE9avis de 30 jours minimum.";default:return""}}soumettreConge(){if(!this.peutSoumettre())return;this.enCoursEnvoi.set(!0);let r=this.authService.getCurrentUser();if(!r){this.enCoursEnvoi.set(!1);return}let n={employeId:r.id,type:this.formData.type,dateDebut:this.formData.dateDebut,dateFin:this.formData.dateFin,nbJours:this.dureeCalculee(),statut:"EN_ATTENTE",motif:this.formData.motif};this.congeService.createConge(n).subscribe({next:i=>{this.enCoursEnvoi.set(!1),this.router.navigate(["/conges"])},error:i=>{this.enCoursEnvoi.set(!1),console.error("Erreur lors de la cr\xE9ation du cong\xE9:",i)}})}formatDate(r){return new Date(r).toLocaleDateString("fr-FR")}static \u0275fac=function(n){return new(n||a)(y(Y),y(U),y(F))};static \u0275cmp=N({type:a,selectors:[["app-nouvelle-conge"]],decls:76,vars:14,consts:[["congeForm","ngForm"],[1,"space-y-6"],[1,"flex","items-center","space-x-4"],["routerLink","/conges",1,"text-primary-600","hover:text-primary-800"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],[1,"card","bg-blue-50","border-blue-200"],[1,"flex","items-center"],[1,"w-12","h-12","bg-blue-100","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"ml-4"],[1,"text-lg","font-semibold","text-blue-900"],[1,"text-blue-700"],[1,"font-bold"],[1,"card","max-w-2xl"],[3,"ngSubmit"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["name","type","required","",1,"input-field",3,"ngModelChange","ngModel"],["value",""],["value","CONGE_PAYE"],["value","CONGE_MALADIE"],["value","CONGE_MATERNITE"],["value","CONGE_SANS_SOLDE"],[1,"mt-2","p-2","bg-gray-50","rounded","text-xs","text-gray-600"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["type","date","name","dateDebut","required","",1,"input-field",3,"ngModelChange","ngModel","min"],["type","date","name","dateFin","required","",1,"input-field",3,"ngModelChange","ngModel","min"],["name","motif","required","","rows","3","placeholder","Pr\xE9cisez le motif de votre demande de cong\xE9",1,"input-field",3,"ngModelChange","ngModel"],["type","text","name","remplacant","placeholder","Nom de la personne qui vous remplacera (optionnel)",1,"input-field",3,"ngModelChange","ngModel"],[1,"mt-1","text-xs","text-gray-500"],["type","tel","name","contactUrgence","placeholder","+225 77 123 45 67",1,"input-field",3,"ngModelChange","ngModel"],[1,"p-3","bg-blue-50","rounded-lg"],[1,"flex","space-x-4","pt-6","border-t"],["type","submit",1,"btn-primary","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["routerLink","/conges",1,"btn-secondary"],[1,"p-4","bg-green-50","rounded-lg","border","border-green-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-green-600","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","font-medium","text-green-800"],[1,"text-xs","text-green-700"],[1,"p-3","bg-red-50","rounded-lg","border","border-red-200"],[1,"text-sm","text-red-800"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-4","text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-8","w-8","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"],[1,"mt-2"],["for","certificat-upload",1,"cursor-pointer"],[1,"btn-secondary"],["id","certificat-upload","name","certificat-upload","type","file","accept",".pdf,.jpg,.jpeg,.png",1,"sr-only",3,"change"],[1,"mt-2","flex","items-center","justify-between","p-2","bg-gray-50","rounded"],[1,"text-sm","text-gray-700"],["type","button",1,"text-red-600","hover:text-red-800",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"text-sm","text-blue-800"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","inline","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-red-600","font-medium"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(n,i){if(n&1){let u=M();e(0,"div",1)(1,"div",2)(2,"a",3),C(),e(3,"svg",4),v(4,"path",5),t()(),x(),e(5,"div")(6,"h1",6),o(7,"Demande de cong\xE9"),t(),e(8,"p",7),o(9,"Cr\xE9ez une nouvelle demande de cong\xE9"),t()()(),e(10,"div",8)(11,"div",9)(12,"div",10),C(),e(13,"svg",11),v(14,"path",12),t()(),x(),e(15,"div",13)(16,"h3",14),o(17,"Solde de cong\xE9s disponible"),t(),e(18,"p",15),o(19,"Vous avez "),e(20,"span",16),o(21,"18 jours"),t(),o(22," de cong\xE9s restants pour cette ann\xE9e"),t()()()(),e(23,"div",17)(24,"form",18,0),S("ngSubmit",function(){return m(u),s(i.soumettreConge())}),e(26,"div",1)(27,"div")(28,"label",19),o(29," Type de cong\xE9 * "),t(),e(30,"select",20),E("ngModelChange",function(l){return m(u),h(i.formData.type,l)||(i.formData.type=l),s(l)}),e(31,"option",21),o(32,"S\xE9lectionnez un type"),t(),e(33,"option",22),o(34,"Cong\xE9 pay\xE9"),t(),e(35,"option",23),o(36,"Cong\xE9 maladie"),t(),e(37,"option",24),o(38,"Cong\xE9 maternit\xE9"),t(),e(39,"option",25),o(40,"Cong\xE9 sans solde"),t()(),p(41,K,2,1,"div",26),t(),e(42,"div",27)(43,"div")(44,"label",19),o(45," Date de d\xE9but * "),t(),e(46,"input",28),E("ngModelChange",function(l){return m(u),h(i.formData.dateDebut,l)||(i.formData.dateDebut=l),s(l)}),S("ngModelChange",function(){return m(u),s(i.calculerDuree())}),t()(),e(47,"div")(48,"label",19),o(49," Date de fin * "),t(),e(50,"input",29),E("ngModelChange",function(l){return m(u),h(i.formData.dateFin,l)||(i.formData.dateFin=l),s(l)}),S("ngModelChange",function(){return m(u),s(i.calculerDuree())}),t()()(),p(51,X,10,4),e(52,"div")(53,"label",19),o(54," Motif * "),t(),e(55,"textarea",30),E("ngModelChange",function(l){return m(u),h(i.formData.motif,l)||(i.formData.motif=l),s(l)}),t()(),e(56,"div")(57,"label",19),o(58," Personne de remplacement "),t(),e(59,"input",31),E("ngModelChange",function(l){return m(u),h(i.formData.remplacant,l)||(i.formData.remplacant=l),s(l)}),t(),e(60,"p",32),o(61," Indiquez qui peut vous remplacer pendant votre absence "),t()(),e(62,"div")(63,"label",19),o(64," Contact d'urgence "),t(),e(65,"input",33),E("ngModelChange",function(l){return m(u),h(i.formData.contactUrgence,l)||(i.formData.contactUrgence=l),s(l)}),t(),e(66,"p",32),o(67," Num\xE9ro o\xF9 vous joindre en cas d'urgence "),t()(),p(68,$,14,1,"div"),p(69,te,6,2,"div",34),e(70,"div",35)(71,"button",36),p(72,ie,4,0)(73,ne,1,0),t(),e(74,"a",37),o(75," Annuler "),t()()()()()()}if(n&2){let u=V(25);d(30),_("ngModel",i.formData.type),d(11),g(i.formData.type?41:-1),d(5),_("ngModel",i.formData.dateDebut),w("min",i.dateMinimum()),d(4),_("ngModel",i.formData.dateFin),w("min",i.formData.dateDebut),d(),g(i.formData.dateDebut&&i.formData.dateFin?51:-1),d(4),_("ngModel",i.formData.motif),d(4),_("ngModel",i.formData.remplacant),d(6),_("ngModel",i.formData.contactUrgence),d(3),g(i.formData.type==="CONGE_MALADIE"?68:-1),d(),g(i.formData.dateDebut?69:-1),d(2),w("disabled",!u.form.valid||i.enCoursEnvoi()||!i.peutSoumettre()),d(),g(i.enCoursEnvoi()?72:73)}},dependencies:[A,j,H,W,q,z,L,B,P,G,R,O,I],encapsulation:2})};export{J as NouvelleConge};
