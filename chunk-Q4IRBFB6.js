import{a as Y}from"./chunk-PLXHDNC7.js";import{c as W,d as L}from"./chunk-K6BAALZU.js";import{a as Q}from"./chunk-PNRCHS3F.js";import{a as I,b as B,c as O,d as R,e as j,f as P,g as q,h as G,i as z,j as U,k as H,l as X,m as J,n as K}from"./chunk-GT7YRUEU.js";import{Ca as b,Lb as k,Ra as _,Sa as h,Ua as M,Va as N,Wa as T,X as u,Xa as e,Y as c,Ya as t,Z as C,Za as S,_ as E,bb as v,cb as y,db as p,ea as w,eb as V,ib as a,jb as F,kb as A,mb as f,nb as g,ob as D,sa as m,wa as x}from"./chunk-5P4XIA3I.js";var $=(o,l)=>l.name;function ee(o,l){if(o&1&&(e(0,"div",39)(1,"p",40),a(2),t()()),o&2){let n=p(2);m(2),A(" Dur\xE9e: ",n.calculerDuree()," jour(s) ")}}function te(o,l){if(o&1){let n=v();e(0,"div",36)(1,"div")(2,"label",10),a(3," Date de d\xE9but * "),t(),e(4,"input",37),D("ngModelChange",function(r){u(n);let d=p();return g(d.formData.dateDebut,r)||(d.formData.dateDebut=r),c(r)}),t()(),e(5,"div")(6,"label",10),a(7," Date de fin * "),t(),e(8,"input",38),D("ngModelChange",function(r){u(n);let d=p();return g(d.formData.dateFin,r)||(d.formData.dateFin=r),c(r)}),t()()(),_(9,ee,3,1,"div",39)}if(o&2){let n=p();m(4),f("ngModel",n.formData.dateDebut),m(4),f("ngModel",n.formData.dateFin),m(),h(n.formData.dateDebut&&n.formData.dateFin?9:-1)}}function ie(o,l){if(o&1){let n=v();e(0,"div")(1,"label",10),a(2," Montant (FCFA) * "),t(),e(3,"input",41),D("ngModelChange",function(r){u(n);let d=p();return g(d.formData.montant,r)||(d.formData.montant=r),c(r)}),t()()}if(o&2){let n=p();m(3),f("ngModel",n.formData.montant)}}function ne(o,l){if(o&1){let n=v();e(0,"div")(1,"label",10),a(2," Type de document * "),t(),e(3,"select",42),D("ngModelChange",function(r){u(n);let d=p();return g(d.formData.typeDocument,r)||(d.formData.typeDocument=r),c(r)}),e(4,"option",12),a(5,"S\xE9lectionnez un document"),t(),e(6,"option",43),a(7,"Attestation de travail"),t(),e(8,"option",44),a(9,"Bulletin de salaire"),t(),e(10,"option",45),a(11,"Certificat m\xE9dical"),t(),e(12,"option",46),a(13,"Autre"),t()()()}if(o&2){let n=p();m(3),f("ngModel",n.formData.typeDocument)}}function ae(o,l){if(o&1){let n=v();e(0,"div",47)(1,"span",48),a(2),t(),e(3,"button",49),y("click",function(){let r=u(n).$implicit,d=p(2);return c(d.retirerFichier(r))}),C(),e(4,"svg",50),S(5,"path",51),t()()()}if(o&2){let n=l.$implicit;m(2),F(n.name)}}function re(o,l){if(o&1&&(e(0,"div",28),M(1,ae,6,1,"div",47,$),t()),o&2){let n=p();m(),N(n.fichiersSelectionnes())}}function oe(o,l){o&1&&(C(),e(0,"svg",52),S(1,"circle",53)(2,"path",54),t(),a(3," Envoi en cours... "))}function le(o,l){o&1&&a(0," Soumettre la demande ")}var Z=class o{constructor(l,n,i){this.demandeService=l;this.authService=n;this.router=i}formData={type:"",titre:"",description:"",dateDebut:"",dateFin:"",montant:0,typeDocument:"",urgent:!1};fichiersSelectionnes=w([]);enCoursEnvoi=w(!1);onTypeChange(){switch(this.formData.dateDebut="",this.formData.dateFin="",this.formData.montant=0,this.formData.typeDocument="",this.formData.type){case"CONGE":this.formData.titre="Demande de cong\xE9";break;case"ABSENCE":this.formData.titre="Demande d'absence";break;case"DOCUMENT":this.formData.titre="Demande de document";break;case"AFFECTATION":this.formData.titre="Demande d'affectation";break;case"NOTE_FRAIS":this.formData.titre="Note de frais";break}}onFileSelect(l){let n=Array.from(l.target.files),i=this.fichiersSelectionnes();this.fichiersSelectionnes.set([...i,...n])}retirerFichier(l){let n=this.fichiersSelectionnes().filter(i=>i!==l);this.fichiersSelectionnes.set(n)}calculerDuree(){if(this.formData.dateDebut&&this.formData.dateFin){let l=new Date(this.formData.dateDebut),n=new Date(this.formData.dateFin),i=Math.abs(n.getTime()-l.getTime());return Math.ceil(i/(1e3*60*60*24))+1}return 0}soumettreDeamnde(){if(!this.formData.type||!this.formData.titre||!this.formData.description)return;this.enCoursEnvoi.set(!0);let l=this.authService.getCurrentUser();if(!l){this.enCoursEnvoi.set(!1);return}let n={employeId:l.id,type:this.formData.type,titre:this.formData.titre,description:this.formData.description,dateDebut:this.formData.dateDebut||void 0,dateFin:this.formData.dateFin||void 0,montant:this.formData.montant||void 0,documents:this.fichiersSelectionnes().map(i=>i.name)};this.demandeService.createDemande(n).subscribe({next:i=>{this.enCoursEnvoi.set(!1),this.router.navigate(["/demandes"])},error:i=>{this.enCoursEnvoi.set(!1),console.error("Erreur lors de la cr\xE9ation de la demande:",i)}})}static \u0275fac=function(n){return new(n||o)(x(Y),x(Q),x(W))};static \u0275cmp=b({type:o,selectors:[["app-nouvelle-demande"]],decls:68,vars:10,consts:[["demandeForm","ngForm"],[1,"space-y-6"],[1,"flex","items-center","space-x-4"],["routerLink","/demandes",1,"text-primary-600","hover:text-primary-800"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],[1,"card","max-w-2xl"],[3,"ngSubmit"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["name","type","required","",1,"input-field",3,"ngModelChange","ngModel"],["value",""],["value","CONGE"],["value","ABSENCE"],["value","DOCUMENT"],["value","AFFECTATION"],["value","NOTE_FRAIS"],["type","text","name","titre","required","","placeholder","Titre de votre demande",1,"input-field",3,"ngModelChange","ngModel"],["name","description","required","","rows","4","placeholder","D\xE9crivez votre demande en d\xE9tail",1,"input-field",3,"ngModelChange","ngModel"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-6","text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"],[1,"mt-4"],["for","file-upload",1,"cursor-pointer"],[1,"btn-secondary"],["id","file-upload","name","file-upload","type","file","multiple","",1,"sr-only",3,"change"],[1,"mt-2","text-sm","text-gray-500"],[1,"mt-4","space-y-2"],[1,"flex","items-center"],["type","checkbox","name","urgent",1,"rounded","border-gray-300","text-primary-600","focus:ring-primary-500",3,"ngModelChange","ngModel"],[1,"ml-2","text-sm","text-gray-700"],[1,"mt-1","text-xs","text-gray-500"],[1,"flex","space-x-4","pt-6","border-t"],["type","submit",1,"btn-primary","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["routerLink","/demandes",1,"btn-secondary"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["type","date","name","dateDebut","required","",1,"input-field",3,"ngModelChange","ngModel"],["type","date","name","dateFin","required","",1,"input-field",3,"ngModelChange","ngModel"],[1,"p-3","bg-blue-50","rounded-lg"],[1,"text-sm","text-blue-800"],["type","number","name","montant","required","","min","0","placeholder","0",1,"input-field",3,"ngModelChange","ngModel"],["name","typeDocument","required","",1,"input-field",3,"ngModelChange","ngModel"],["value","ATTESTATION_TRAVAIL"],["value","BULLETIN_SALAIRE"],["value","CERTIFICAT_MEDICAL"],["value","AUTRE"],[1,"flex","items-center","justify-between","p-2","bg-gray-50","rounded"],[1,"text-sm","text-gray-700"],["type","button",1,"text-red-600","hover:text-red-800",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(n,i){if(n&1){let r=v();e(0,"div",1)(1,"div",2)(2,"a",3),C(),e(3,"svg",4),S(4,"path",5),t()(),E(),e(5,"div")(6,"h1",6),a(7,"Nouvelle demande"),t(),e(8,"p",7),a(9,"Cr\xE9ez une nouvelle demande"),t()()(),e(10,"div",8)(11,"form",9,0),y("ngSubmit",function(){return u(r),c(i.soumettreDeamnde())}),e(13,"div",1)(14,"div")(15,"label",10),a(16," Type de demande * "),t(),e(17,"select",11),D("ngModelChange",function(s){return u(r),g(i.formData.type,s)||(i.formData.type=s),c(s)}),y("ngModelChange",function(){return u(r),c(i.onTypeChange())}),e(18,"option",12),a(19,"S\xE9lectionnez un type"),t(),e(20,"option",13),a(21,"Demande de cong\xE9"),t(),e(22,"option",14),a(23,"Demande d'absence"),t(),e(24,"option",15),a(25,"Demande de document"),t(),e(26,"option",16),a(27,"Demande d'affectation"),t(),e(28,"option",17),a(29,"Note de frais"),t()()(),e(30,"div")(31,"label",10),a(32," Titre * "),t(),e(33,"input",18),D("ngModelChange",function(s){return u(r),g(i.formData.titre,s)||(i.formData.titre=s),c(s)}),t()(),e(34,"div")(35,"label",10),a(36," Description * "),t(),e(37,"textarea",19),D("ngModelChange",function(s){return u(r),g(i.formData.description,s)||(i.formData.description=s),c(s)}),t()(),_(38,te,10,3),_(39,ie,4,1,"div"),_(40,ne,14,1,"div"),e(41,"div")(42,"label",10),a(43," Documents joints "),t(),e(44,"div",20),C(),e(45,"svg",21),S(46,"path",22),t(),E(),e(47,"div",23)(48,"label",24)(49,"span",25),a(50," Choisir des fichiers "),t(),e(51,"input",26),y("change",function(s){return u(r),c(i.onFileSelect(s))}),t()(),e(52,"p",27),a(53," PDF, DOC, DOCX jusqu'\xE0 10MB "),t()()(),_(54,re,3,0,"div",28),t(),e(55,"div")(56,"label",29)(57,"input",30),D("ngModelChange",function(s){return u(r),g(i.formData.urgent,s)||(i.formData.urgent=s),c(s)}),t(),e(58,"span",31),a(59," Demande urgente "),t()(),e(60,"p",32),a(61," Les demandes urgentes seront trait\xE9es en priorit\xE9 "),t()(),e(62,"div",33)(63,"button",34),_(64,oe,4,0)(65,le,1,0),t(),e(66,"a",35),a(67," Annuler "),t()()()()()()}if(n&2){let r=V(12);m(17),f("ngModel",i.formData.type),m(16),f("ngModel",i.formData.titre),m(4),f("ngModel",i.formData.description),m(),h(i.formData.type==="CONGE"||i.formData.type==="ABSENCE"?38:-1),m(),h(i.formData.type==="NOTE_FRAIS"?39:-1),m(),h(i.formData.type==="DOCUMENT"?40:-1),m(14),h(i.fichiersSelectionnes().length>0?54:-1),m(3),f("ngModel",i.formData.urgent),m(6),T("disabled",!r.form.valid||i.enCoursEnvoi()),m(),h(i.enCoursEnvoi()?64:65)}},dependencies:[k,L,K,q,U,H,B,G,I,z,O,R,J,X,P,j],encapsulation:2})};export{Z as NouvelleDemande};
